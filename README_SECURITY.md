# 인플루언서 맵 보안 및 인증 설정 가이드

토스 파트너 API 연동을 위해 필요한 보안 설정들을 안내합니다.

## 1. 복호화 키 (Decryption Key) 설정
이메일로 받으신 **복호화 키**는 사용자 성명, 전화번호 등을 평문으로 읽기 위해 필수입니다.

```bash
# 터미널에서 실행
npx supabase secrets set TOSS_DECRYPT_KEY="여기에_이메일로_받은_키_입력"
```

## 2. mTLS 인증서 설정 (필수)
토스 파트너 API는 보안을 위해 상호 인증(mTLS)을 요구합니다.

### A. 인증서 발급
1. 토스 개발자 센터 > 내 앱 > 보안 섹션에서 **인증서 발급 신청**을 클릭합니다.
2. CSR을 생성하고, 토스에서 발급해주는 `.crt` (인증서) 파일을 다운로드합니다.
3. 발급 과정에서 생성된 `.key` (개인키) 파일도 함께 준비합니다.

### B. Supabase 등록
인증서 파일의 내용을 복사하여 아래 환경 변수로 등록합니다. (개행 문자가 포함되어도 괜찮습니다.)

```bash
# 1. 인증서 등록 (-----BEGIN CERTIFICATE----- 로 시작하는 내용 전체)
npx supabase secrets set TOSS_CERT="인증서_파일_내용_전체"

# 2. 개인키 등록 (-----BEGIN PRIVATE KEY----- 로 시작하는 내용 전체)
npx supabase secrets set TOSS_KEY="개인키_파일_내용_전체"
```

## 3. 설정 확인
모든 값이 설정되면 `toss-login` 함수가 자동으로 이를 인식하여 토스 API와 보안 통신을 시작합니다.
샌드박스 환경에서 로그인을 시도하여 사용자 이름과 정보가 올바르게 DB에 저장되는지 확인하세요.
